(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function n(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(i){if(i.ep)return;i.ep=!0;const r=n(i);fetch(i.href,r)}})();let e={line_width:10,stroke_color:"#000",canvasHst:[],redo:[],saveCanvas:null,mouseMoveHandler:null,initX:null,initY:null,ctx:null,canvas:null};function u(t,o){return o.getImageData(0,0,t.width,t.height)}function d(t,o,n){const{initX:s,initY:i,line_width:r,stroke_color:a}=e;n.beginPath(),n.moveTo(s,i),n.lineWidth=r,n.strokeStyle=a,n.lineCap="round",n.lineJoin="round",n.lineTo(t,o),n.stroke(),e.initX=t,e.initY=o}const p=(t,o)=>n=>{n.preventDefault();let s,i,r;n.changedTouches?(r=n.target.getBoundingClientRect(),s=n.changedTouches[0].pageX,i=n.changedTouches[0].pageY):(r=o,s=n.offsetX,i=n.offsetY),d(s-r.left,i-r.top,t)},c=(t,o,n)=>s=>{s.preventDefault();let i;if(e.redo.length>0&&(e.redo=[]),e.saveCanvas=u(n,t),e.canvasHst.push(e.saveCanvas),s.changedTouches){i="touchmove";let r=s.target.getBoundingClientRect();e.initX=s.changedTouches[0].pageX-r.left,e.initY=s.changedTouches[0].pageY-r.top}else i="mousemove",e.initX=s.offsetX-o.left,e.initY=s.offsetY-o.top;d(e.initX,e.initY,t),e.mouseMoveHandler=p(t,o),n.addEventListener(i,e.mouseMoveHandler)};function g(t,o){const n=t.getBoundingClientRect();t.addEventListener("mousedown",c(o,n,t)),t.addEventListener("touchstart",c(o,n,t))}function m(t,o,n){if(!o){if(e.redo.length===0)return;let r=e.redo.pop();e.canvasHst.push(u(n,t)),t.putImageData(r,0,0);return}if(e.canvasHst.length===0)return;let s=u(n,t);e.redo.push(s);let i=e.canvasHst.pop();t.putImageData(i,0,0)}function v(t){const o=t.target;if(o.closest(".btn-return")){const n=o.closest(".btn-left");m(e.ctx,!n,e.canvas);return}o.closest(".btn-reset")&&(e.ctx.clearRect(0,0,e.canvas.width,e.canvas.height),e.canvasHst=[],e.redo=[])}let l;function f(t,o){l=u(t,o),t.width=window.innerWidth*.9,t.height=window.innerHeight*.7,o.putImageData(l,0,0)}const E={color:t=>{e.stroke_color=t.value},lineWidth:t=>{e.line_width=parseInt(t.value)}};function w(t){const o=t.target,n=o.dataset.handlerType,s=E[n];s&&s(o)}const y=(t,o,n)=>{t.removeEventListener(n,e.mouseMoveHandler)};function h(t){let o=t.changedTouches?"touchmove":"mousemove";y(e.canvas,e.ctx,o)}document.getElementById("app");e.canvas=document.querySelector("canvas");e.ctx=e.canvas.getContext("2d",{willReadFrequently:!0});g(e.canvas,e.ctx);f(e.canvas,e.ctx);window.addEventListener("resize",()=>f(e.canvas,e.ctx));document.addEventListener("click",v);document.addEventListener("input",w);document.addEventListener("mouseup",h);document.addEventListener("touchend",h);
