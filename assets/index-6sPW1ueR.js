(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function o(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=o(i);fetch(i.href,a)}})();let e={line_width:10,stroke_color:"#000",canvasHst:[],redo:[],saveCanvas:null,moveHandler:null,initX:null,initY:null,ctx:null,canvas:null};function d(t,n){if(!(!t.width||!t.height))return n.getImageData(0,0,t.width,t.height)}function c(t,n,o){const{initX:r,initY:i,line_width:a,stroke_color:s}=e;o.beginPath(),o.moveTo(r,i),o.lineWidth=a,o.strokeStyle=s,o.lineCap="round",o.lineJoin="round",o.lineTo(t,n),o.stroke(),e.initX=t,e.initY=n}const p=t=>n=>{n.preventDefault();let o=n.target.getBoundingClientRect(),{pageX:r,pageY:i}=n.changedTouches?n.changedTouches[0]:n;c(r-o.left,i-o.top,t)},l=(t,n)=>o=>{o.cancelable&&o.preventDefault();let r,i=o.target.getBoundingClientRect();e.redo.length>0&&(e.redo=[]),e.saveCanvas=d(n,t),e.canvasHst.push(e.saveCanvas),o.changedTouches?(r="touchmove",e.initX=o.changedTouches[0].pageX-i.left,e.initY=o.changedTouches[0].pageY-i.top):(r="mousemove",e.initX=o.pageX-i.left,e.initY=o.pageY-i.top),c(e.initX,e.initY,t),e.moveHandler=p(t),n.addEventListener(r,e.moveHandler)};function g(t,n){t.addEventListener("mousedown",l(n,t)),t.addEventListener("touchstart",l(n,t))}function m(t,n,o){if(!n){if(e.redo.length===0)return;let a=e.redo.pop();e.canvasHst.push(d(o,t)),t.putImageData(a,0,0);return}if(e.canvasHst.length===0)return;let r=d(o,t);e.redo.push(r);let i=e.canvasHst.pop();t.putImageData(i,0,0)}function v(t){const n=t.target;if(n.closest(".btn-return")){const o=n.closest(".btn-left");m(e.ctx,!o,e.canvas);return}n.closest(".btn-reset")&&(e.ctx.clearRect(0,0,e.canvas.width,e.canvas.height),e.canvasHst=[],e.redo=[])}function u(t,n,o){let r=d(t,n);t.width=o.offsetWidth*.95||window.innerWidth*.9,t.height=window.innerHeight*.8,n.putImageData(r,0,0)}const E={color:t=>{e.stroke_color=t.value},lineWidth:t=>{e.line_width=parseInt(t.value)}};function w(t){const n=t.target,o=n.dataset.handlerType,r=E[o];r&&r(n)}const y=(t,n,o)=>{t.removeEventListener(o,e.moveHandler)};function h(t){let n=t.changedTouches?"touchmove":"mousemove";y(e.canvas,e.ctx,n)}const f=document.getElementById("app");e.canvas=document.querySelector("canvas");e.ctx=e.canvas.getContext("2d",{willReadFrequently:!0});u(e.canvas,e.ctx,f);g(e.canvas,e.ctx);window.addEventListener("resize",()=>u(e.canvas,e.ctx,f));document.addEventListener("click",v);document.addEventListener("input",w);document.addEventListener("mouseup",h);document.addEventListener("touchend",h);
