(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function o(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=o(r);fetch(r.href,i)}})();let e={line_width:10,stroke_color:"#000",canvasHst:[],redo:[],saveCanvas:null,mouseMoveHandler:null,initX:null,initY:null,ctx:null,canvas:null};function a(t,n){return n.getImageData(0,0,t.width,t.height)}function d(t,n,o){o.beginPath(),o.moveTo(e.initX,e.initY),o.lineWidth=e.line_width,o.strokeStyle=e.stroke_color,o.lineCap="round",o.lineJoin="round",o.lineTo(t,n),o.stroke(),e.initX=t,e.initY=n}const f=(t,n)=>o=>{o.preventDefault(),d(o.offsetX-n.left,o.offsetY-n.top,t)},p=(t,n,o)=>s=>{s.preventDefault(),e.initX=s.offsetX-n.left,e.initY=s.offsetY-n.top,e.saveCanvas=a(o,t),e.redo.length>0&&(e.redo=[]),e.canvasHst.push(e.saveCanvas),d(e.initX,e.initY,t),e.mouseMoveHandler=f(t,n),o.addEventListener("mousemove",e.mouseMoveHandler)};function v(t,n){const o=t.getBoundingClientRect();t.addEventListener("mousedown",p(n,o,t))}function m(t,n,o){if(!n){if(e.redo.length===0)return;let i=e.redo.pop();e.canvasHst.push(a(o,t)),t.putImageData(i,0,0);return}if(e.canvasHst.length===0)return;let s=a(o,t);e.redo.push(s);let r=e.canvasHst.pop();t.putImageData(r,0,0)}function h(t){const n=t.target;if(n.closest(".btn-return")){const o=n.closest(".btn-left");m(e.ctx,!o,e.canvas);return}n.closest(".btn-reset")&&(e.ctx.clearRect(0,0,e.canvas.width,e.canvas.height),e.canvasHst=[],e.redo=[])}let u;function c(t,n){u=a(t,n),t.width=window.innerWidth*.9,t.height=window.innerHeight*.7,n.putImageData(u,0,0)}const g={color:t=>{e.stroke_color=t.value},lineWidth:t=>{e.line_width=parseInt(t.value)}};function w(t){const n=t.target,o=n.dataset.handlerType,s=g[o];console.log(n.dataset),s&&s(n)}const E=(t,n)=>()=>{t.removeEventListener("mousemove",e.mouseMoveHandler)};function y(){E(e.canvas)()}document.getElementById("app");e.canvas=document.querySelector("canvas");e.ctx=e.canvas.getContext("2d",{willReadFrequently:!0});v(e.canvas,e.ctx);c(e.canvas,e.ctx);window.addEventListener("resize",()=>c(e.canvas,e.ctx));document.addEventListener("click",h);document.addEventListener("input",w);document.addEventListener("mouseup",y);
